# EMA Hardening Security
![WordPress Plugin Version](https://img.shields.io/badge/Version-1.3.1-blue.svg)
![WordPress Version](https://img.shields.io/badge/WordPress-5.0+-brightgreen.svg)
![License](https://img.shields.io/badge/License-GPLv2-orange.svg)

**Autor:** Eberton M. Alvares

Um plugin de seguranÃ§a completo para WordPress, projetado para proteger, monitorar e reparar seu site contra as ameaÃ§as mais comuns. Desenvolvido com foco em performance, precisÃ£o e facilidade de uso.

---

## Tabela de ConteÃºdos

- [VisÃ£o Geral](#visÃ£o-geral)
- [Funcionalidades Principais](#funcionalidades-principais)
- [InstalaÃ§Ã£o](#instalaÃ§Ã£o)
- [Como Usar](#como-usar)
  - [Dashboard Principal](#dashboard-principal)
  - [Scanner de SeguranÃ§a](#scanner-de-seguranÃ§a)
  - [Log de Atividades](#log-de-atividades)
- [Estrutura dos Arquivos](#estrutura-dos-arquivos)
- [Como Contribuir](#como-contribuir)
- [LicenÃ§a](#licenÃ§a)

---

## VisÃ£o Geral

O **EMA Hardening Security** Ã© uma suÃ­te de seguranÃ§a para WordPress que visa eliminar os vetores de ataque mais comuns e fornecer ferramentas de monitoramento e recuperaÃ§Ã£o. Diferente de plugins pesados, ele foi construÃ­do para ser leve e eficiente, aplicando as melhores prÃ¡ticas de seguranÃ§a sem comprometer a performance do site.

O plugin atua em mÃºltiplas frentes:
- **PrevenÃ§Ã£o:** Bloqueia ataques em tempo real com um firewall e fortalece as defesas nativas do WordPress.
- **DetecÃ§Ã£o:** Identifica modificaÃ§Ãµes nÃ£o autorizadas, malware e atividades suspeitas atravÃ©s de um scanner completo e um log de auditoria.
- **RecuperaÃ§Ã£o:** Permite a restauraÃ§Ã£o de arquivos do core do WordPress com um Ãºnico clique.

---

## Funcionalidades Principais

#### ðŸ›¡ï¸ Firewall de AplicaÃ§Ã£o Web (WAF)
- Bloqueia em tempo real requisiÃ§Ãµes maliciosas contendo padrÃµes de **SQL Injection**, **Cross-Site Scripting (XSS)** e **Directory Traversal** antes que atinjam o WordPress.

#### ðŸ”’ ProteÃ§Ã£o de Login
- Limita o nÃºmero de tentativas de login falhas por endereÃ§o IP, prevenindo ataques de **forÃ§a bruta**.
- IPs que excedem o limite sÃ£o temporariamente bloqueados para mitigar ataques automatizados.

#### âš™ï¸ Hardening (Fortalecimento do Core)
- **Desabilita o editor de arquivos** do painel para prevenir modificaÃ§Ãµes nÃ£o autorizadas.
- **Oculta a versÃ£o do WordPress** para dificultar o trabalho de scanners de vulnerabilidades.
- **Bloqueia completamente o acesso ao XML-RPC**, um vetor comum de ataques de forÃ§a bruta e DDoS.
- **Protege a API REST** contra a enumeraÃ§Ã£o de usuÃ¡rios, impedindo que atacantes descubram nomes de usuÃ¡rio vÃ¡lidos.
- Adiciona **cabeÃ§alhos de seguranÃ§a HTTP** para proteger contra clickjacking, XSS e sniffing de conteÃºdo.

#### ðŸš« Anti-Spam
- Implementa um campo **"honeypot" invisÃ­vel** nos formulÃ¡rios de comentÃ¡rio para enganar e bloquear bots de spam.
- IPs identificados como spam sÃ£o adicionados a uma lista de bloqueio.

#### ðŸ•µï¸ Scanner de SeguranÃ§a Completo
- Um scanner multi-etapas que verifica toda a sua instalaÃ§Ã£o do WordPress de forma segura e sem sobrecarregar o servidor:
    - **Integridade do Core:** Compara os arquivos do `wp-admin` e `wp-includes` com os originais do WordPress.org.
        - **Reparo AutomÃ¡tico:** Permite restaurar arquivos do core modificados e deletar arquivos desconhecidos com um Ãºnico clique.
    - **Scan de Malware:** Verifica todos os arquivos do site (incluindo `wp-content`) em busca de assinaturas de malware e backdoors conhecidos.
    - **Scan de Banco de Dados:** Analisa seus posts e pÃ¡ginas em busca de conteÃºdo suspeito (scripts/iframes), verifica a integridade das URLs do site e lista os usuÃ¡rios administradores para revisÃ£o.

#### ðŸ“Š Log de Atividades
- MantÃ©m um registro detalhado (trilha de auditoria) de todos os eventos importantes que ocorrem no site, como:
    - Logins bem-sucedidos e falhos.
    - AtivaÃ§Ã£o e desativaÃ§Ã£o de plugins.
    - Troca de temas.
    - CriaÃ§Ã£o, atualizaÃ§Ã£o e exclusÃ£o de posts e usuÃ¡rios.

---

## InstalaÃ§Ã£o

#### A partir do GitHub:
1.  FaÃ§a o download do repositÃ³rio como um arquivo `.zip`.
2.  No painel do WordPress, vÃ¡ para **Plugins > Adicionar Novo**.
3.  Clique em **Enviar plugin** e escolha o arquivo `.zip` que vocÃª baixou.
4.  Instale e ative o plugin.

#### Manualmente:
1.  Clone ou faÃ§a o download do repositÃ³rio.
2.  FaÃ§a o upload da pasta `ema-hardening` para o seu diretÃ³rio de plugins (`/wp-content/plugins/`).
3.  Acesse o menu "Plugins" no painel do WordPress.
4.  Ative o plugin "EMA Hardening Security".

ApÃ³s a ativaÃ§Ã£o, as funcionalidades de proteÃ§Ã£o serÃ£o ativadas automaticamente.

---

## Como Usar

ApÃ³s a ativaÃ§Ã£o, um novo menu chamado **"EMA Security"** aparecerÃ¡ no seu painel.

### Dashboard Principal
-   **Local:** `EMA Security`
-   **DescriÃ§Ã£o:** Esta Ã© a pÃ¡gina principal. Ela mostra um resumo do status de todas as proteÃ§Ãµes ativas e um log dos Ãºltimos IPs bloqueados pelo firewall ou pelo sistema anti-spam.

### Scanner de SeguranÃ§a
-   **Local:** `EMA Security > Scanner de SeguranÃ§a`
-   **Como Usar:**
    1.  Navegue atÃ© a pÃ¡gina para iniciar uma verificaÃ§Ã£o completa.
    2.  Clique em **"Iniciar VerificaÃ§Ã£o Completa"**.
    3.  Aguarde o processo terminar. O status serÃ¡ atualizado em tempo real, mostrando cada etapa da verificaÃ§Ã£o.
    4.  Analise os resultados. Se arquivos do core forem sinalizados, vocÃª terÃ¡ a opÃ§Ã£o de **"Restaurar"** (para arquivos modificados) ou **"Deletar"** (para arquivos desconhecidos).

### Log de Atividades
-   **Local:** `EMA Security > Log de Atividades`
-   **DescriÃ§Ã£o:** Esta pÃ¡gina exibe a trilha de auditoria de tudo o que acontece no seu site. Use-a para monitorar a atividade de usuÃ¡rios e identificar aÃ§Ãµes suspeitas.

---

## Estrutura dos Arquivos
ema-hardening/
â”œâ”€â”€ admin/
â”‚ â”œâ”€â”€ ema-admin-page.php # Dashboard principal
â”‚ â”œâ”€â”€ ema-logs-page.php # PÃ¡gina do Log de Atividades
â”‚ â”œâ”€â”€ ema-scanner-page.php # PÃ¡gina do Scanner de SeguranÃ§a
â”‚ â””â”€â”€ js/
â”‚ â””â”€â”€ scanner.js # LÃ³gica JavaScript para o scanner
â”œâ”€â”€ includes/
â”‚ â”œâ”€â”€ ema-activity-logger.php # LÃ³gica de registro de eventos
â”‚ â”œâ”€â”€ ema-anti-spam.php # FunÃ§Ãµes de honeypot e bloqueio de spam
â”‚ â””â”€â”€ ema-hardening-functions.php # FunÃ§Ãµes de fortalecimento e seguranÃ§a
â”œâ”€â”€ ema-hardening.php # Arquivo principal do plugin
â””â”€â”€ README.md # Este arquivo
code
Code
---

## Como Contribuir

ContribuiÃ§Ãµes sÃ£o bem-vindas! Se vocÃª deseja melhorar o plugin, por favor, siga os seguintes passos:

1.  **FaÃ§a um Fork** do repositÃ³rio.
2.  **Crie uma nova Branch** para sua feature (`git checkout -b feature/minha-feature`).
3.  **FaÃ§a o Commit** das suas alteraÃ§Ãµes (`git commit -m 'Adiciona minha-feature'`).
4.  **FaÃ§a o Push** para a Branch (`git push origin feature/minha-feature`).
5.  **Abra um Pull Request**.